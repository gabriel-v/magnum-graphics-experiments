#!/bin/bash -ex

cd "$(dirname ${BASH_SOURCE[0]})"
cd lib/magnum
(
    rm -rf build
    mkdir build && cd build
	# -DMAGNUM_WITH_SDL2APPLICATION=ON \
    cmake .. \
	-DMAGNUM_WITH_PYTHON=ON \
	-DMAGNUM_BUILD_STATIC=ON \
	-DCMAKE_TOOLCHAIN_FILE="$VIDEOGAME_EMSCRIPTEN_TOOLCHAIN" \
	-DCMAKE_PREFIX_PATH="$VIDEOGAME_INSTALL_LOCATION;/usr/local;/usr/share;/usr/lib" \
	-DCMAKE_FIND_ROOT_PATH="$VIDEOGAME_INSTALL_LOCATION" \
	-DCMAKE_INSTALL_PREFIX="$VIDEOGAME_INSTALL_LOCATION" \
	# -DMAGNUM_WITH_EMSCRIPTENAPPLICATION=ON \
	# -DMAGNUM_WITH_WINDOWLESSEGLAPPLICATION=ON \
	# -DCMAKE_BUILD_TYPE=Release
	# -DCMAKE_INSTALL_PREFIX=/usr \

    make -j8
    make install
)
